# Obtener lista de archivos CSV en la carpeta
archivos_csv <- list.files(path = ruta_archivos, pattern = "\\.csv$", full.names = TRUE)
archivos_csv
library(dplyr)
library(readr)
library(purrr)  # Lee múltiples archivos a la vez
# Definir la ruta de los archivos
ruta_archivos <- "C:/Users/mpord/Documents/3IngSoft/2Cuatri/G4.Dedalus/material_dedalus/"
# Obtener lista de archivos CSV en la carpeta
archivos_csv <- list.files(path = ruta_archivos, pattern = "\\.csv$", full.names = TRUE)
archivos_csv
# Leer y combinar todos los archivos en un solo DataFrame
df <- map_df(archivos_csv, read_csv)
df
View(df)
df_agg <- df %>%
group_by(PacienteID) %>%
summarise(
Edad_Promedio = mean(Edad, na.rm = TRUE),  # Calcular la edad promedio
Diagnosticos = paste(unique(Diagnóstico), collapse = "; "),  # Unir diagnósticos únicos
Primera_Fecha = min(Fecha, na.rm = TRUE)  # Obtener la fecha más antigua
)
source("~/.active-rstudio-document", echo=TRUE)
View(df)
View(resumen_lab_iniciales)
View(resumen_lab_iniciales)
View(resumen_notas)
View(resumen_pacientes)
View(resumen_pacientes)
View(resumen_procedimientos)
View(resumen_procedimientos)
source("~/.active-rstudio-document", echo=TRUE)
View(df)
clr
clean
cln
ruta_archivos <- "C:/Users/mpord/Documents/3IngSoft/2Cuatri/G4.Dedalus/material_dedalus/DataSetIndividuales/"
# Obtener lista de archivos CSV en la carpeta
archivos_csv <- list.files(path = ruta_archivos, pattern = "\\.csv$", full.names = TRUE)
archivos_csv
df <- map_df(archivos_csv, read_csv)
df_agg <- df %>%
group_by(PacienteID) %>%
summarise(
Edad_Promedio = mean(Edad, na.rm = TRUE),  # Calcular la edad promedio
Diagnosticos = paste(unique(Diagnóstico), collapse = "; "),  # Unir diagnósticos únicos
Primera_Fecha = min(Fecha, na.rm = TRUE)  # Obtener la fecha más antigua
)
# Definir la ruta de los archivos
ruta_archivos <- "ruta/a/tus/csv/"
# Obtener lista de archivos CSV en la carpeta
archivos_csv <- list.files(path = ruta_archivos, pattern = "\\.csv$", full.names = TRUE)
# Leer todos los archivos y asegurarse de que todas las columnas sean incluidas
df_list <- map(archivos_csv, ~ read_csv(.x, show_col_types = FALSE))
# Unir todos los archivos en un solo DataFrame, asegurando todas las columnas
df <- bind_rows(df_list, .id = "Archivo_Origen")  # Agrega la columna de origen del archivo (opcional)
df
source("~/.active-rstudio-document", echo=TRUE)
View(df_final)
View(df_final)
write_csv(df_final, "resumen_pacientes_combinados.csv")
resumen_evolucion_process <- read.csv("C:/Users/mpord/Documents/3IngSoft/2Cuatri/G4.Dedalus/material_dedalus/resumen_evolucion_process.csv")
View(resumen_evolucion_process)
library(tidyverse)
library(jsonlite)
View(resumen_evolucion_process)
|>
df_agg <- resumen_evolucion_process |>
group_by(PacienteID) |>
summarise(
Diagnosticos = toJSON(list(na.omit(unique(Diagnostico)))),  # Eliminar NA antes de agrupar
Tratamientos = toJSON(list(na.omit(unique(Tratamiento))))   # Eliminar NA antes de agrupar
)
df_agg
source("C:/Users/mpord/Documents/3IngSoft/2Cuatri/G4.Dedalus/material_dedalus/AgrupacionDatosJSON.R", echo=TRUE)
colnames(resumen_evolucion_process)
colnames(resumen_evolucion_process)
df_agg <- resumen_evolucion_process |>
group_by(PacienteID) |>
summarise(
across(
.cols = -PacienteID,  # Excluir la columna PacienteID
.fns = ~ toJSON(list(na.omit(unique(.)))),  # Convertir cada columna a JSON-like
.names = "{.col}_json"  # Crear un nombre nuevo para cada columna agregada
)
)
source("C:/Users/mpord/Documents/3IngSoft/2Cuatri/G4.Dedalus/material_dedalus/AgrupacionDatosJSON.R", echo=TRUE)
View(df_agg)
resumen_evolucion_process <- read.csv("C:/Users/mpord/Documents/3IngSoft/2Cuatri/G4.Dedalus/material_dedalus/resumen_evolucion_process.csv")
df <- resumen_evolucion_process
df$Fecha <- paste(df$Fecha,df$Hora,sep= "-")
df$Hora <- NULL
View(df)
df_agg <- df %>%
group_by(PacienteID) %>%
summarise(
DatosPorFecha = toJSON(
list(
# Agrupar por FechaHora
`FechaHora` = list(
lapply(
split(df, df$FechaHora),  # Agrupar por FechaHora
function(x) {
# Extraemos los valores de laboratorio y los agrupamos
as.list(
across(
.cols = -c(PacienteID,Fecha),  # Filtrar por las columnas de laboratorio
.fns = ~ unique(na.omit(.))  # Obtener valores únicos y omitir NAs
)
)
}
)
)
)
)
)
df_agg <- df |>
group_by(PacienteID)
View(df_agg)
# Extraemos los valores de laboratorio y los agrupamos
list(
across(
.cols = -c(PacienteID,Fecha),  # Filtrar por las columnas de laboratorio
.fns = ~ unique(na.omit(.))  # Obtener valores únicos y omitir NAs
)
)
pacientes1 <-  df |>
filter(PacienteID = 1)
pacientes1 <-  df |>
filter(PacienteID == 1)
View(pacientes1)
df_agg <- df |>
group_by(PacienteID) |>
summarise(
DatosPorFecha = toJSON(
list(
# Agrupar por FechaHora
`FechaHora` = list(
lapply(
split(df, df$FechaHora),  # Agrupar por FechaHora
function(x) {
# Extraemos los valores de laboratorio y los agrupamos
list(
across(
.cols = -c(PacienteID,Fecha),  # Filtrar por las columnas de laboratorio
.fns = ~ unique(na.omit(.))  # Obtener valores únicos y omitir NAs
)
)
}
)
)
)
)
)
df_agg <- df %>%
group_by(PacienteID) %>%
summarise(
DatosPorFecha = toJSON(
list(
`FechaHora` = lapply(
split(., .$FechaHora),  # Ahora, dividir por FechaHora dentro de cada grupo PacienteID
function(x) {
# Extraer los valores de laboratorio y agrupados
as.list(
across(
.cols = -c(PacienteID, FechaHora),  # Excluir columnas no deseadas (PacienteID y FechaHora)
.fns = ~ unique(na.omit(.))  # Obtener valores únicos y omitir NAs
)
)
}
)
)
)
)
df_agg <- df %>%
group_by(PacienteID, FechaHora) %>%
summarise(
DatosLaboratorio = list(
across(
.cols = -c(PacienteID, FechaHora),  # Excluye PacienteID y FechaHora
.fns = ~ unique(na.omit(.))  # Obtén los valores únicos y elimina NA
)
),
.groups = "drop"  # Para evitar mantener el agrupamiento después
) %>%
group_by(PacienteID) %>%
summarise(
DatosPorFecha = toJSON(
list(
`FechaHora` = lapply(split(., .$FechaHora), function(x) {
as.list(x$DatosLaboratorio)
})
)
),
.groups = "drop"
)
df_agg <- df %>%
group_by(PacienteID, Fecha) %>%
summarise(
DatosLaboratorio = list(
across(
.cols = -c(PacienteID, Fecha),  # Excluye PacienteID y FechaHora
.fns = ~ unique(na.omit(.))  # Obtén los valores únicos y elimina NA
)
),
.groups = "drop"  # Para evitar mantener el agrupamiento después
) %>%
group_by(PacienteID) %>%
summarise(
DatosPorFecha = toJSON(
list(
`FechaHora` = lapply(split(., .$FechaHora), function(x) {
as.list(x$DatosLaboratorio)
})
)
),
.groups = "drop"
)
df_agg <- df %>%
group_by(PacienteID, Fecha) %>%
summarise(
DatosLaboratorio = list(
across(
.cols = -c(PacienteID, Fecha),  # Excluye PacienteID y FechaHora
.fns = ~ unique(na.omit(.))  # Obtén los valores únicos y elimina NA
)
),
.groups = "drop"  # Para evitar mantener el agrupamiento después
) %>%
group_by(PacienteID) %>%
summarise(
DatosPorFecha = toJSON(
list(
`FechaHora` = lapply(split(., .$Fecha), function(x) {
as.list(x$DatosLaboratorio)
})
)
),
.groups = "drop"
)
colnames(df)
colnames(df(-2:))
colnames(df)(-2)
colnames(df)(-2:)
colnames(df)[[-2]]
class(colnames(df))
colnames(df)[-c(1, 2)]
json_por_fila <- lapply(df[-c(1, 2)], toJSON())
json_por_fila <- lapply(df[-c(1, 2)], function(fila) {
toJSON(as.list(fila), auto_unbox = TRUE)
})
View(json_por_fila)
class(json_por_fila)
mutate(df, JSON=json_por_fila)
View(df)
jsondataframe <- mutate(df, JSON=json_por_fila)
View(jsondataframe)
df_no_na <- df
df_no_na[is.na(df_no_na)] <- NULL
df_no_na <- df
df_no_na[is.na(df_no_na)] <- NULL
View(df_no_na)
df_no_na <- df
df_no_na[is.na(df_no_na)] <- NULL
df_no_na <- df
df_no_na[is.na(df_no_na)] <- NULL
json_por_fila <- lapply(df_no_na[-c(1, 2)],1, function(fila) {
toJSON(as.list(fila), auto_unbox = TRUE)
})
json_por_fila <- lapply(df[-c(1, 2)], function(fila) {
toJSON(as.list(fila), auto_unbox = TRUE,na="none")
})
json_por_fila <- lapply(df[-c(1, 2)], function(fila) {
toJSON(as.list(fila), auto_unbox = TRUE,na="null")
})
class(json_por_fila)
jsondataframe <- mutate(df_no_na, JSON=json_por_fila)
View(df)
json_list <- apply(df[-c(PacienteID,Fecha)], 1, function(row) {
json <- toJSON(as.list(row), auto_unbox = TRUE)
return(json)
})
json_list <- apply(df[-c(PacienteID,Fecha)], 1, function(row) {
json <- toJSON(as.list(row), auto_unbox = TRUE)
return(json)
})
df
json <- toJSON(as.list(row), auto_unbox = TRUE)
json_list <- apply(df[-c(df$PacienteID,df$Fecha)], 1, function(row) {
json <- toJSON(as.list(row), auto_unbox = TRUE)
})
json_por_fila <- apply(df[-c(1, 2)], function(fila) {
toJSON(as.list(row), auto_unbox = TRUE,na="null")
})
json_por_fila <- apply(df[-c(1, 2)],1, function(fila) {
toJSON(as.list(row), auto_unbox = TRUE,na="null")
})
json_por_fila <- lapply(df[-c(1, 2)], function(fila) {
toJSON(as.list(row), auto_unbox = TRUE,na="null")
})
# Convertir la fila a lista y luego a JSON
json <- toJSON(as.list(row), auto_unbox = TRUE)
df
source("C:/Users/mpord/Documents/3IngSoft/2Cuatri/G4.Dedalus/material_dedalus/AgrupacionDatosJSON.R", echo=TRUE)
json_result <- toJSON(df[-c(1,2)], pretty = TRUE)
# Mostrar el resultado JSON
cat(json_result)
df_json <- mutate(df,JSON=json_result)
View(df_json)
View(df_json)
json_result_2 <- toJSON(df[c(2,30)], pretty = TRUE)
json_result_2 <- toJSON(df_json[c(2,30)], pretty = TRUE)
df_json$JSON <- json_result_2
cat(json_result_2)
json_result <- toJSON(df[-c(1)], pretty = TRUE)
# Mostrar el resultado JSON
cat(json_result)
df_json$JSON <- json_result
df_grouped <- df %>%
group_by(PacienteID) %>%
summarise(
registros = list(
data.frame(
Fecha = Fecha,
Hora = Hora,
PresionSistolica = PresionSistolica,
PresionDiastolica = PresionDiastolica,
FrecuenciaCardiaca = FrecuenciaCardiaca,
Temperatura = Temperatura,
FrecuenciaRespiratoria = FrecuenciaRespiratoria,
SaturacionOxigeno = SaturacionOxigeno,
Glucosa = Glucosa,
Leucocitos = Leucocitos,
Hemoglobina = Hemoglobina,
Plaquetas = Plaquetas,
Colesterol = Colesterol,
HDL = HDL,
LDL = LDL,
Trigliceridos = Trigliceridos,
Sodio = Sodio,
Potasio = Potasio,
Cloro = Cloro,
Creatinina = Creatinina,
Urea = Urea,
AST = AST,
ALT = ALT,
Bilirrubina = Bilirrubina,
pH = pH,
pCO2 = pCO2,
pO2 = pO2,
HCO3 = HCO3,
Lactato = Lactato
)
),
.groups = "drop"
)
df_grouped <- df %>%
group_by(PacienteID) %>%
summarise(
registros = list(
data.frame(
Fecha = Fecha,
PresionSistolica = PresionSistolica,
PresionDiastolica = PresionDiastolica,
FrecuenciaCardiaca = FrecuenciaCardiaca,
Temperatura = Temperatura,
FrecuenciaRespiratoria = FrecuenciaRespiratoria,
SaturacionOxigeno = SaturacionOxigeno,
Glucosa = Glucosa,
Leucocitos = Leucocitos,
Hemoglobina = Hemoglobina,
Plaquetas = Plaquetas,
Colesterol = Colesterol,
HDL = HDL,
LDL = LDL,
Trigliceridos = Trigliceridos,
Sodio = Sodio,
Potasio = Potasio,
Cloro = Cloro,
Creatinina = Creatinina,
Urea = Urea,
AST = AST,
ALT = ALT,
Bilirrubina = Bilirrubina,
pH = pH,
pCO2 = pCO2,
pO2 = pO2,
HCO3 = HCO3,
Lactato = Lactato
)
),
.groups = "drop"
)
# Convertir a JSON
json_result <- toJSON(df_grouped, pretty = TRUE, auto_unbox = TRUE)
# Mostrar el resultado JSON
cat(json_result)
View(df_grouped)
View(df_grouped[[2]][[1]])
View(df_grouped[[2]][[2]])
View(df_grouped[[2]][[1]])
write.csv(df_grouped,"resumen_evolucion_json.csv")
df_flattened <- df_grouped %>%
unnest(cols = c(registros))
# Guardar el resultado en un archivo CSV
write.csv(df_flattened, "output.csv", row.names = FALSE)
write_json(json_result,"datos_evolucion.json")
data_pac <- data.entry(JSON=df_grouped[2])
data_pac <- data.frame(JSON=df_grouped[2])
View(data_pac)
View(data_pac[[1]][[1]])
data_pac <- data.frame(JSON=json_result)
View(resumen_evolucion_process)
View(resumen_evolucion_process)
library(arules)
install.packages("arulesViz")
source("~/.active-rstudio-document", echo=TRUE)
as.data.frame(p1)
p1 <- resumen_evolucion_process |>
filter(resumen_evolucion_process$PacienteID=="1")
p1 <- resumen_evolucion_process |>
filter(resumen_evolucion_process$PacienteID=="1")
p1 <- which(resumen_evolucion_process,resumen_evolucion_process$PacienteID==1)
p1 <- resumen_evolucion_process[1:14,]
View(jsondataframe)
View(pacientes1)
View(p1)
p1 <- resumen_evolucion_process[1:16,]
p2 <- resumen_evolucion_process[16,]
View(p2)
p2 <- resumen_evolucion_process[16:,]
p2 <- resumen_evolucion_process[16:27,]
View(p2)
source("~/.active-rstudio-document", echo=TRUE)
resumen_lab_iniciales <- read.csv("C:/Users/mpord/Documents/3IngSoft/2Cuatri/G4.Dedalus/material_dedalus/DatosSQUAD/resumen_lab_iniciales.csv")
View(resumen_lab_iniciales)
resumen_pacientes <- read.csv("C:/Users/mpord/Documents/3IngSoft/2Cuatri/G4.Dedalus/material_dedalus/DatosSQUAD/resumen_pacientes.csv")
View(resumen_pacientes)
df_nombre <- cbind(resumen_lab_iniciales,Nombre=resumen_pacientes$Nombre)
View(df_nombre)
write.csv(df_nombre,file="resumen_lab_iniciales_conNombre.csv",row.names = FALSE)
resumen_medicacion <- read.csv("C:/Users/mpord/Documents/3IngSoft/2Cuatri/G4.Dedalus/material_dedalus/DatosSQUAD/resumen_medicacion.csv")
View(resumen_medicacion)
resumen_medicacion <- read.csv("C:/Users/mpord/Documents/3IngSoft/2Cuatri/G4.Dedalus/material_dedalus/DatosSQUAD/resumen_medicacion.csv")
df_nombre <- cbind(resumen_medicacion,Nombre=resumen_pacientes$Nombre)
resumen_medicacion <- read.csv("C:/Users/mpord/Documents/3IngSoft/2Cuatri/G4.Dedalus/material_dedalus/DatosSQUAD/resumen_medicacion.csv")
df_nombre <- cbind(resumen_medicacion,Nombre=resumen_pacientes$Nombre)
resumen_pacientes$Nombre
resumen_notas <- read.csv("C:/Users/mpord/Documents/3IngSoft/2Cuatri/G4.Dedalus/material_dedalus/DatosSQUAD/resumen_notas.csv")
View(resumen_notas)
source("C:/Users/mpord/Documents/3IngSoft/2Cuatri/G4.Dedalus/material_dedalus/EstandarizacionDeFechas.R", echo=TRUE)
r
version
# Supongamos que la columna que contiene las fechas se llama "fecha"
# Convertir las fechas a un formato estándar y luego formatearlas al formato "dd/MM/YYYY"
resumen_notas$Fecha <- as.Date(datos$fecha, format="%d/%m/%Y")  # Si las fechas son en formato "dd/MM/yyyy", o usa mdy(), ymd(), etc., según el caso
# Supongamos que la columna que contiene las fechas se llama "fecha"
# Convertir las fechas a un formato estándar y luego formatearlas al formato "dd/MM/YYYY"
resumen_notas$Fecha <- as.Date(resumen_notas$Fecha, format="%d/%m/%Y")  # Si las fechas son en formato "dd/MM/yyyy", o usa mdy(), ymd(), etc., según el caso
# Leer el CSV (ajusta la ruta al archivo)
resumen_notas <- read.csv("C:/Users/mpord/Documents/3IngSoft/2Cuatri/G4.Dedalus/material_dedalus/DatosSQUAD/resumen_notas.csv")
# Ver las primeras filas para inspeccionar las fechas
resumen_notas
# Supongamos que la columna que contiene las fechas se llama "fecha"
# Convertir las fechas a un formato estándar y luego formatearlas al formato "dd/MM/YYYY"
resumen_notas$Fecha <- as.Date(resumen_notas$Fecha, format="%d/%m/%Y")  # Si las fechas son en formato "dd/MM/yyyy", o usa mdy(), ymd(), etc., según el caso
View(resumen_notas)
resumen_notas
View(resumen_notas)
resumen_notas <- read.csv("C:/Users/mpord/Documents/3IngSoft/2Cuatri/G4.Dedalus/material_dedalus/DatosSQUAD/resumen_notas.csv")
View(resumen_notas)
# Supongamos que la columna que contiene las fechas se llama "fecha"
# Convertir las fechas a un formato estándar y luego formatearlas al formato "dd/MM/YYYY"
resumen_notas$Fecha <- as.Date(resumen_notas$Fecha, format="%d/%m/%Y")  # Si las fechas son en formato "dd/MM/yyyy", o usa mdy(), ymd(), etc., según el caso
# Ahora formateamos la columna "fecha" al formato "dd/MM/YYYY"
resumen_notas$Fecha <- format(resumen_notas$Fecha, "%d/%m/%Y")
# Leer el CSV (ajusta la ruta al archivo)
datos <- read.csv("C:/Users/mpord/Documents/3IngSoft/2Cuatri/G4.Dedalus/material_dedalus/DatosSQUAD/resumen_notas.csv")
# Renombrar las columnas para mayor claridad
colnames(datos) <- c("ID", "Fecha", "Nota")
# Ver las primeras filas para inspeccionar las fechas
head(datos)
# Función para convertir las fechas al formato dd/MM/yyyy
convertir_fecha <- function(fecha) {
# Si la fecha está en formato yyyy-MM-dd (Ej: 2024-08-09)
if (grepl("^\\d{4}-\\d{2}-\\d{2}$", fecha)) {
fecha_convertida <- as.Date(fecha, format="%Y-%m-%d")
} else if (grepl("^\\d{2}/\\d{2}/\\d{4}$", fecha)) {  # Si está en formato dd/MM/yyyy (Ej: 13/07/2023)
fecha_convertida <- as.Date(fecha, format="%d/%m/%Y")
} else {
fecha_convertida <- NA  # Si no se encuentra el formato, dejarlo como NA
}
return(format(fecha_convertida, "%d/%m/%Y"))
}
# Aplicar la función de conversión a la columna 'fecha'
datos$Fecha <- sapply(datos$Fecha, convertir_fecha)
# Verificar los resultados
head(datos)
View(datos)
resumen_notas <- read.csv("C:/Users/mpord/Documents/3IngSoft/2Cuatri/G4.Dedalus/material_dedalus/DatosSQUAD/resumen_notas.csv")
View(resumen_notas)
source("C:/Users/mpord/Documents/3IngSoft/2Cuatri/G4.Dedalus/material_dedalus/EstandarizacionDeFechas.R", echo=TRUE)
head(resumen_notas)
tail(resumen_notas)
source("C:/Users/mpord/Documents/3IngSoft/2Cuatri/G4.Dedalus/material_dedalus/EstandarizacionDeFechas.R", echo=TRUE)
source("C:/Users/mpord/Documents/3IngSoft/2Cuatri/G4.Dedalus/material_dedalus/EstandarizacionDeFechas.R", echo=TRUE)
source("C:/Users/mpord/Documents/3IngSoft/2Cuatri/G4.Dedalus/material_dedalus/EstandarizacionDeFechas.R", echo=TRUE)
load("C:/Users/mpord/Documents/3IngSoft/2Cuatri/G4.Dedalus/material_dedalus/R/.RData")
resumen_procedimientos <- read.csv("C:/Users/mpord/Documents/3IngSoft/2Cuatri/G4.Dedalus/material_dedalus/DatosSQUAD/resumen_procedimientos.csv")
View(resumen_procedimientos)
resumen_pacientes <- read.csv("C:/Users/mpord/Documents/3IngSoft/2Cuatri/G4.Dedalus/material_dedalus/DatosSQUAD/resumen_pacientes.csv")
View(resumen_pacientes)
